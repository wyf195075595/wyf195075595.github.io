---
title: 正则表达式
date: 2022-06-17 08:23:10
tags: js
categories: js
---

### 匹配模式符

```

-i	忽略大小写
-g	全局模式
-m	多行模式
-y	粘附模式,查找从 lastIndex开始及之后的字符串
-u	Unicode匹配
-s	doAll模式，匹配任何字符（包括 \n,\r）

2、字符转译 
为区别字符和语法 ( [ { \ ^ $ | ) ] } ? * + 等符号 作为匹配字符串时前面要加 \ (如\.)
```



## 使用技巧

### 匹配两个字符（串）中甲的内容

<!--more-->

```js

（?<=要匹配的开始字符），不包含后面要匹配的字符写法（？=要匹配的结束字符） 
```

| 表达式         | 说明                                             |
| -------------- | ------------------------------------------------ |
| (?!exp)        | 零宽负向先行断言 后面不能出现 exp 指定的内容     |
| (?<!exp)       | 零宽负向后行断言 前面不能出现exp指定的内容       |
| A.*?B          | 匹配两个字符串A与B中间的字符串包含A与B：         |
| A.*?(?=B)      | 匹配两个字符串A与B中间的字符串包含A但是不包含B： |
| (?<=A).*?(?=B) | 匹配两个字符串A与B中间的字符串且不包含A与B：     |
| ?: A           | 因子匹配后面有 A 时才开始匹配                    |

### 反向断言

> (?=p)	p 前面(位置)
>
> (?<=p) 	p 后面(位置)
>
> (?!p)	除了 p 前面(位置)
>
> (?<!p>)	除了 p 后面(位置)

```js
let rge =  /(?<=upload\/).*?(?=\))/;
let str = `![/933237779136155.6.png](http://127.0.0.1:5000/upload/933237779136155.6.png)`;
let rs = str.match(rge);
console.log(rs) 
//["933237779136155.6.png", index: 55, input: "![/933237779136155.6.png](http://127.0.0.1:5000/upload/933237779136155.6.png)", groups: undefined]
```

### 匹配汉字

```js
var reg = new RegExp("[\\u4E00-\\u9FFF]+","g");
reg.test('123132与8989');//true
```

## 正则表达式修饰符

**修饰符** 可以在全局搜索中不区分大小写:

| 修饰符 | 描述                                                        |
| :----- | :---------------------------------------------------------- |
| y      | 粘附模式，表示只查找从 lastIndex 开始及之后的字符串。       |
| u      | Unicode 模式，启用 Unicode 匹配。                           |
| s      | dotAll 模式，表示元字符（.） 匹配任何字符（包括\n 或\r）。. |
| i      | 执行对大小写不敏感的匹配。                                  |
| g      | 执行全局匹配（查找所有匹配而非在找到第一个匹配后停止）。    |
| m      | 执行多行匹配。                                              |



------

## 正则表达式模式

方括号用于查找某个范围内的字符：

| 表达式 | 描述                       |
| :----- | :------------------------- |
| [abc]  | 查找方括号之间的任何字符。 |
| [0-9]  | 查找任何从 0 至 9 的数字。 |
| [a-z]  | 匹配小写a-z                |
| (x\|y) | 查找任何以 \| 分隔的选项。 |
| [A-Z]  | 匹配大写A-Z                |
| [A-z]  | 匹配所有大小写字母         |

符是拥有特殊含义的字符：

| 元字符 | 描述                                        |
| :----- | :------------------------------------------ |
| \d     | 查找数字。                                  |
| \s     | 查找空白字符。                              |
| \b     | 匹配单词边界。                              |
| \w     | 等价于 [A-Z a-z 0-9_]                       |
| \uxxxx | 查找以十六进制数 xxxx 规定的 Unicode 字符。 |
| .      | 匹配换行符之外得所有                        |

量词:

| 量词   | 描述                                  |
| :----- | :------------------------------------ |
| n+     | 匹配任何包含至少一个 *n* 的字符串。   |
| n*     | 匹配任何包含零个或多个 *n* 的字符串。 |
| n?     | 匹配任何包含零个或一个 *n* 的字符串。 |
| *?     | 重复任意次，但尽可能少重复            |
| ??     | 重复0次或1次，但尽可能少重复          |
| {n,m}? | 重复n到m次，但尽可能少重复            |
| {n,}?  | 重复n次以上，但尽可能少重复           |
| +?     | 重复1次或更多次，但尽可能少重复       |

其他

| \|                    | 选择符   1\|2 匹配其中任意                                   |
| --------------------- | ------------------------------------------------------------ |
| ^                     | 开头                                                         |
| [^ a-z]               | 匹配非a-z                                                    |
| $                     | 匹配结尾                                                     |
| /(.)\1+/g             | \1则是代表与第一个小括号中要匹配的内容相同，同理，例如“/(.)/1(\d)/2/g”中的“/2”代表的就是”(\d)"，其余的以此类推 |
| str.replace(reg,"$1") | $1和$2则分别表示第一个小括号和第二个小括号所匹配到的内容     |



### 字符串中的方法

```js
1、match
变量说明
    0 匹配到的完整内容 
    1,2.... 匹配到的原子组 
    index 原字符串中的位置 起始下标
    input 原字符串 
    groups 命名分组 
 匹配不到则返回null
 
 2、matchAll
 匹配是一个可以迭代的对象,类似于 match + g，为所有匹配的匹配对象返回一个迭代器

3、split

4、replace
```

【注意】

```js
1、每个 RegExp 实例都有下列属性，提供有关模式的各方面信息。
 global：布尔值，表示是否设置了 g 标记。 
 ignoreCase：布尔值，表示是否设置了 i 标记。 
 unicode：布尔值，表示是否设置了 u 标记。
 sticky：布尔值，表示是否设置了 y 标记。 
 lastIndex：整数，表示在源字符串中下一次搜索的开始位置，始终从 0 开始。 
 multiline：布尔值，表示是否设置了 m 标记。 
 dotAll：布尔值，表示是否设置了 s 标记。 
 source：正则表达式的字面量字符串（不是传给构造函数的模式字符串），没有开头和结尾的 斜杠。 
 flags：正则表达式的标记字符串。始终以字面量而非传入构造函数的字符串模式形式返回（没 有前后斜杠）。

全局模式下 res.lastIndex 每次匹配都会发生变化，记录上次匹配最后字符的下标，下次匹配从处此开始
let reg = /a/g;
reg.test('22222asdf');//true

此时的reg.lastIndex 会变成 5

reg.test('22222asdf');//false 


2、展示了几个正则表达式的字面量形式，以及使用 RegExp 构造函数创建时对应的模式字符串。

字面量模式 			对应的字符串 
/\[bc\]at/ 			"\\[bc\\]at" 
/\.at/ 				"\\.at" 
/name\/age/ 		"name\\/age" 
/\w\\hello\\123/ 	"\\w\\\\hello\\\\123"

eg: let eg = /\[bc\]at/g;
    let eg = new RegExp("\\[bc\\]at", g);



3、字符串去重
    	var reg = /(.)\1{1,}/g;
    	var str = "abbcccdeeeefgaa";//要演示的目标字符串
    	var res2 = str.replace(reg,"$1")//其中一种应用，实现字符串去重
    	console.log("字符串去重结果:",res2)    
		//     var res1 = str.match(reg)//匹配两个或两个以上连续字符
		//     console.log("匹配结果:",res1)


常用正则
https://blog.csdn.net/apple151128/article/details/50457055

4、命名捕获组

const reg = /(?<year>[0-9]{4})-(?<month>[0-9]{2})-(?<day>[0-9]{2})/;
const match = reg.exec('2021-02-23');

// 输出 match
"2021-02-23",
"2021",
"02",
"23",
groups:{ day: "23",month: "02",year: "2021"},
index: 0,
input: "2021-02-23"
```

```
matchAll()方法

exec,test 方法会改变RegExp 的lastIndex 属性。 如果exec()没有找到匹配项，会重置 lastIndex 为 0

在ES2020及之后的版本中，应该使用String的matchAll()方法而不是exec()来避开这个问题，因为matchAll()不会修改lastIndex。[1] 有一个例外，就是在字符类中（方括号中），\b匹配退格字符。[2] 使用正则表达式解析URL并不是个好注意。本书11.9节介绍了一个更靠谱的URL解析器。

```





数字转中文

```js
function convertToChinaNum(num) {    

    var arr1 = new Array('零', '一', '二', '三', '四', '五', '六', '七', '八', '九');    

    var arr2 = new Array('', '十', '百', '千', '万', '十', '百', '千', '亿', '十', '百', '千','万', '十', '百', '千','亿');//可继续追加更高位转换值    

    if(!num || isNaN(num)){        

        return "零";    

    }    

    var english = num.toString().split("")    

    var result = "";    

    for (var i = 0; i < english.length; i++) {        

        var des_i = english.length - 1 - i;//倒序排列设值        

        result = arr2[i] + result;        

        var arr1_index = english[des_i];        

        result = arr1[arr1_index] + result;    

    }    

    //将【零千、零百】换成【零】 【十零】换成【十】    

    result = result.replace(/零(千|百|十)/g, '零').replace(/十零/g, '十');    

    //合并中间多个零为一个零    

    result = result.replace(/零+/g, '零');    

    //将【零亿】换成【亿】【零万】换成【万】    

    result = result.replace(/零亿/g, '亿').replace(/零万/g, '万');    

    //将【亿万】换成【亿】    

    result = result.replace(/亿万/g, '亿');    

    //移除末尾的零    

    result = result.replace(/零+$/, '')    

    //将【零一十】换成【零十】    

    //result = result.replace(/零一十/g, '零十');

    //貌似正规读法是零一十    

    //将【一十】换成【十】    

    result = result.replace(/^一十/g, '十');    

    return result;

 }
```

